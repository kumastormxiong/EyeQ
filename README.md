# Visualize Assistant 使用指南

## 软件简介

Visualize Assistant 是一款多模态智能助手，通过屏幕区域截图+文本提问的方式，调用通义千问API进行智能问答。它能让你随时随地对屏幕上的任何内容进行提问，并获得AI的专业解答。

### 核心功能
- **快捷键呼出**：按下`Ctrl+Alt+A`（可在设置中修改）快速呼出窗口
- **自动获取选中内容**：高亮选中屏幕上的文字后，按快捷键自动填入提问框
- **区域截图**：鼠标框选任意区域进行截图
- **多模态问答**：结合截图和文本提问，获得更准确的回答
- **系统托盘**：最小化到系统托盘，随时可呼出
- **对话历史**：保存所有对话记录，方便回顾

## 安装步骤

1. **安装依赖库**
   ```bash
   pip install PyQt5 keyboard pyautogui requests pyperclip pillow
   ```

2. **配置API密钥**
   - 打开 `Assistant/config.ini` 文件
   - 将 `[API]` 部分的 `api_key` 替换为你的通义千问API密钥
   ```ini
   [API]
   api_key = 你的通义千问API密钥
   ```
   - 如果没有API密钥，请前往[通义千问开放平台](https://dashscope.aliyun.com/)申请

3. **运行程序**
   ```bash
   python Assistant/main.py
   ```

## 使用方法

### 基本操作流程

1. **呼出窗口**
   - 按下快捷键 `Ctrl+Alt+A`（可在设置中修改）
   - 或从系统托盘图标（右下角）点击"显示"

2. **提问方式一：直接提问**
   - 在输入框中输入问题
   - 按回车键发送

3. **提问方式二：选中文本后提问**
   - 在任意应用中用鼠标选中文字
   - 按下快捷键 `Ctrl+Alt+A`
   - 选中的文字会自动填入输入框
   - 根据需要编辑问题，按回车发送

4. **提问方式三：截图提问**
   - 呼出窗口后，点击"截图并提问"按钮
   - 用鼠标框选屏幕区域
   - 在弹出的输入框中输入问题，按回车发送

5. **查看回复**
   - AI回复会显示在对话历史区域
   - 所有对话自动保存到本地数据库

### 窗口操作

- **拖动窗口**：按住窗口任意位置拖动
- **调整透明度**：使用底部滑块
- **最小化**：窗口会自动隐藏到系统托盘
- **关闭**：点击右上角"×"按钮

### 系统托盘操作

- **显示窗口**：双击托盘图标或右键菜单选择"显示"
- **退出程序**：右键托盘图标选择"退出"

## 快捷键设置

1. 点击窗口底部的"设置"按钮
2. 在设置对话框中可以：
   - 修改截图快捷键（默认为`Ctrl+Alt+A`）
   - 设置是否使用回车发送消息

## 常见问题

### 1. API密钥未设置
**问题**：提示"API密钥未设置"
**解决方法**：在 `config.ini` 文件中填写正确的通义千问API密钥

### 2. 快捷键不响应
**问题**：按下快捷键没有反应
**解决方法**：
- 检查是否有其他程序占用了相同的快捷键
- 尝试在设置中更换其他快捷键
- 确保程序正在运行（检查系统托盘）

### 3. 截图失败
**问题**：无法完成截图或截图黑屏
**解决方法**：
- 确保已安装 `pyautogui` 和 `pillow` 库
- 尝试以管理员身份运行程序
- 检查是否有屏幕录制/截图限制软件在运行

### 4. 发送问题失败
**问题**：按回车无法发送问题
**解决方法**：
- 检查设置中"回车发送信息"选项是否开启
- 确保问题输入框不为空
- 检查网络连接和API密钥是否正确

## 数据存储

- 截图保存在 `Assistant/data/screenshots/` 目录
- 对话历史保存在 `Assistant/data/conversations.db` 数据库文件

## 技术支持

如有问题或建议，请提交Issue或联系开发者。

---

祝您使用愉快！
